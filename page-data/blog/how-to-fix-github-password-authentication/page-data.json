{"componentChunkName":"component---src-lekoarts-gatsby-theme-minimal-blog-core-templates-post-query-tsx","path":"/blog/how-to-fix-github-password-authentication","result":{"data":{"post":{"__typename":"MdxPost","slug":"/blog/how-to-fix-github-password-authentication","title":"How to Fix GitHub Actions: Support for password authentication was removed","date":"01.08.2022","tags":[{"name":"Ops","slug":"ops"}],"description":null,"canonicalUrl":null,"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"How to Fix GitHub Actions: Support for password authentication was removed\",\n  \"subtitle\": \"Linking private repos as npm dependencies the proper way\",\n  \"date\": \"2022-08-01T00:00:00.000Z\",\n  \"slug\": \"/blog/how-to-fix-github-password-authentication\",\n  \"tags\": [\"Ops\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(ScrollToTopButton, {\n    mdxType: \"ScrollToTopButton\"\n  }), mdx(\"p\", null, \"Today the GitHub PAT (\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"personal access token\"), \") expired in \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://tweak-extension.com\"\n  }, \"one of my projects\"), \", I literally waked up to this:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"npm ERR! code 128\\nnpm ERR! An unknown git error occurred\\nnpm ERR! command git --no-replace-objects ls-remote https://***@github.com/org/my-dep.git\\nnpm ERR! remote: Support for password authentication was removed on August 13, 2021.\\nnpm ERR! remote: Please see https://docs.github.com/en/get-started/getting-started-with-git/about-remote-repositories#cloning-with-https-urls for information on currently recommended modes of authentication.\\nnpm ERR! fatal: Authentication failed for 'https://github.com/org/my-dep.git/'\\n\\nnpm ERR! A complete log of this run can be found in:\\nnpm ERR!     /home/runner/.npm/_logs/2022-08-01T16_02_11_768Z-debug-0.log\\nError: Process completed with exit code 128.\\n\")), mdx(\"br\", null), mdx(\"br\", null), \"(\\u256F\\xB0\\u25A1\\xB0)\\u256F\\uFE35 \\u253B\\u2501\\u253B\", mdx(\"br\", null), mdx(\"br\", null), mdx(\"p\", null, \"It happens that GitHub droped the support to pass along the password to auth on private repos, which is part of my workflow, because I link npm dependencies with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"git+https\"), \" schema, in my \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"package.json\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"// package.json\\n\\\"dependencies\\\": {\\n  // ...\\n  \\\"my-dep\\\": \\\"git+https://<PAT_TOKEN_GOES_HERE>@github.com/org/my-dep.git#3b3b3371d24b31d18bfef6296635df37f7131925\\\",\\n  // ...\\n\")), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\uD83D\\uDCA1 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"#3b3b3371d24b31d18bfef6296635df37f7131925\"), \" targets a specific commit.\")), mdx(\"p\", null, \"Well for some reason this was not working anymore, that's somewhat good, because I had my PTA hardcoded right there \\uD83E\\uDD20\"), mdx(\"h2\", {\n    \"id\": \"lets-fix-it\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Let's fix it!\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#lets-fix-it\",\n    \"aria-label\": \"lets fix it permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"style\": {\n      \"paddingLeft\": \"12px\"\n    },\n    \"width\": \"28\",\n    \"height\": \"16\",\n    \"fill\": \"#9f7aea\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"The proper way to this, which also addresses the issue I've posted initially, is the following.\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"First \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token\"\n  }, \"create a new PAT\"), \" - ideally with minimum amount of scopes.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Now you have your PAT you'll have to make it accessible to whatever repo where you will use the token in its GitHub action. Add this to the \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://docs.github.com/en/actions/security-guides/encrypted-secrets\"\n  }, \"repo secrets\"), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Great, now my tricky work around. Because I can only install this via GitHub (\", mdx(\"em\", {\n    parentName: \"li\"\n  }, \"limited infra available to manage packages\"), \"), I add my target dependency under \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"optionalDependencies\"), \" rather than \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"dependencies\"), \" in the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"package.json\"), \". This means we will use \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"npm install --no-optional\"), \" in our CI in order to skip the dependency that needs auth to download the package from a private repo.\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"\\\"optionalDependencies\\\": {\\n  \\\"my-dep\\\": \\\"git+https://github.com/org/my-dep.git#3b3b3371d24b31d18bfef6296635df37f7131925\\\"\\n},\\n\")), mdx(\"ol\", {\n    \"start\": 4\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Now \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"in your GitHub action add the additional\"), \" steps.\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yml\"\n  }, \"  - run: npm install --no-optional\\n  - run: npm install git+https://$TOKEN@github.com/org/my-dep.git#3b3b3371d24b31d18bfef6296635df37f7131925\\n  env:\\n    TOKEN: ${{ secrets.MY_PAT_SECRET }}\\n\")), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\uD83D\\uDCA1 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MY_PAT_SECRET\"), \" needs to match the secret name you added in GitHub.\")), mdx(\"p\", null, \"Hope this workaround helps you as it helped me!\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"Today the GitHub PAT ( personal access token ) expired in  one of my projects , I literally waked up to this: It happens that GitHub dropedâ€¦","timeToRead":1,"banner":null,"parent":{"__typename":"Mdx","frontmatter":{"subtitle":"Linking private repos as npm dependencies the proper way"}}}},"pageContext":{"slug":"/blog/how-to-fix-github-password-authentication","formatString":"DD.MM.YYYY"}},"staticQueryHashes":["3090400250","3090400250","318001574"]}
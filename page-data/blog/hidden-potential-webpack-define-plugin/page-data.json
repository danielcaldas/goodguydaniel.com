{"componentChunkName":"component---src-lekoarts-gatsby-theme-minimal-blog-core-templates-post-query-tsx","path":"/blog/hidden-potential-webpack-define-plugin/","result":{"data":{"post":{"__typename":"MdxPost","slug":"/blog/hidden-potential-webpack-define-plugin/","title":"The hidden potential of webpack DefinePlugin","date":"30.05.2019","tags":[{"name":"JavaScript","slug":"java-script"},{"name":"Webpack","slug":"webpack"}],"description":null,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"The hidden potential of webpack DefinePlugin\",\n  \"date\": \"2019-05-30T00:00:00.000Z\",\n  \"slug\": \"/blog/hidden-potential-webpack-define-plugin/\",\n  \"tags\": [\"JavaScript\", \"Webpack\"]\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(ScrollToTopButton, {\n    mdxType: \"ScrollToTopButton\"\n  }), mdx(\"p\", null, \"The odds are high that you're using \", mdx(\"a\", {\n    href: \"https://webpack.js.org/\",\n    target: \"_blank\",\n    title: \"a bundler for javascript and friends\"\n  }, \"webpack\"), \" to bundle your assets. If you're looking into an excellent way to feed environment variables to your applications, \", mdx(\"a\", {\n    href: \"https://webpack.js.org/plugins/define-plugin/#usage\",\n    target: \"_blank\",\n    title: \"the defineplugin allows you to create global constants which can be configured at compile time\"\n  }, \"DefinePlugin\"), \" might well be the answer.\"), mdx(\"h3\", {\n    \"id\": \"tldr\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"tl;dr\", mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"href\": \"#tldr\",\n    \"aria-label\": \"tldr permalink\",\n    \"className\": \"anchor after\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"style\": {\n      \"paddingLeft\": \"12px\"\n    },\n    \"width\": \"28\",\n    \"height\": \"16\",\n    \"fill\": \"#9f7aea\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))))), mdx(\"p\", null, \"If you want to pass environment variables and use it within your JavaScript, you need to:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Create the environment variable.\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"MY_ENV_VAR=\\\"sweet env var\\\"\\n\")), mdx(\"ol\", {\n    \"start\": 2\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"In your webpack config, use the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"webpack.DefinePlugin\"), \".\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"new webpack.DefinePlugin({\\n  // it won't work without JSON.stringify!!!\\n  myEnvVar: JSON.stringify(process.env.MY_ENV_VAR),\\n});\\n\")), mdx(\"ol\", {\n    \"start\": 3\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"In your JavaScript.\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"console.log(`Accessing my env var like a ninja: ${myEnvVar}`);\\n\")), mdx(\"br\", null), mdx(\"br\", null), mdx(\"h3\", {\n    \"id\": \"some-background\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Some Background\", mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"href\": \"#some-background\",\n    \"aria-label\": \"some background permalink\",\n    \"className\": \"anchor after\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"style\": {\n      \"paddingLeft\": \"12px\"\n    },\n    \"width\": \"28\",\n    \"height\": \"16\",\n    \"fill\": \"#9f7aea\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))))), mdx(\"p\", null, \"One of these days, I had this exciting challenge, I was integrating some third party that required from me to provide the current commit hash of the code to a JavaScript SDK that performs some magic in bug tracking and versioning.\"), mdx(\"p\", null, \"Well seemed pretty simple for me at the time. I need to take the commit hash at build time and somehow feed it to our JavaScript, whatever that means.\"), mdx(\"p\", null, \"In this blog post, I'll explain step by step how to implement the following:\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"We want to log in the console the link to the GitHub history of the application\\nthat points to the commit of the current version of the application.\")), mdx(\"h4\", {\n    \"id\": \"the-step-by-step\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"The step by step\", mdx(\"a\", _extends({\n    parentName: \"h4\"\n  }, {\n    \"href\": \"#the-step-by-step\",\n    \"aria-label\": \"the step by step permalink\",\n    \"className\": \"anchor after\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"style\": {\n      \"paddingLeft\": \"12px\"\n    },\n    \"width\": \"28\",\n    \"height\": \"16\",\n    \"fill\": \"#9f7aea\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))))), mdx(\"p\", null, \"Here's a step by step implementation of the previously announced challenge. I will use one of my open source pet projects on GitHub, \", mdx(\"a\", {\n    href: \"https://github.com/danielcaldas/el-conversor\",\n    target: \"_blank\",\n    title: \"a number to word list converter as a node backend and react/redux fronted\"\n  }, \"el-conversor\"), \".\"), mdx(\"h5\", {\n    \"id\": \"step-1---grab-the-commit-hash\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Step 1 - Grab the commit hash\", mdx(\"a\", _extends({\n    parentName: \"h5\"\n  }, {\n    \"href\": \"#step-1---grab-the-commit-hash\",\n    \"aria-label\": \"step 1   grab the commit hash permalink\",\n    \"className\": \"anchor after\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"style\": {\n      \"paddingLeft\": \"12px\"\n    },\n    \"width\": \"28\",\n    \"height\": \"16\",\n    \"fill\": \"#9f7aea\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))))), mdx(\"p\", null, \"I'm going to do this within a npm script in the \", mdx(\"a\", {\n    href: \"https://github.com/danielcaldas/el-conversor/blob/master/package.json#L17\",\n    target: \"_blank\",\n    title: \"a number to word list converter as a node backend and react/redux fronted package.json\"\n  }, \"package.json\"), \". In the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"dev\"), \" npm script you can find the following:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"\\\"dev\\\": \\\"COMMIT_HASH=\\\\\\\"$(git rev-parse HEAD)\\\\\\\" npm-run-all --parallel *:dev\\\",\\n\")), mdx(\"p\", null, \"So in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"COMMIT_HASH=\\\\\\\"$(git rev-parse HEAD)\\\\\\\"\"), \" we are basically assigning the output of the command \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"git rev-parse HEAD\"), \" to an env variable \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"COMMIT_HASH\"), \".\"), mdx(\"h5\", {\n    \"id\": \"step-2---configure-webpackdefineplugin\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Step 2 - Configure webpack.DefinePlugin\", mdx(\"a\", _extends({\n    parentName: \"h5\"\n  }, {\n    \"href\": \"#step-2---configure-webpackdefineplugin\",\n    \"aria-label\": \"step 2   configure webpackdefineplugin permalink\",\n    \"className\": \"anchor after\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"style\": {\n      \"paddingLeft\": \"12px\"\n    },\n    \"width\": \"28\",\n    \"height\": \"16\",\n    \"fill\": \"#9f7aea\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))))), mdx(\"p\", null, \"Now, let's dive into the \", mdx(\"a\", {\n    href: \"https://github.com/danielcaldas/el-conversor/blob/master/package.json#L17\",\n    target: \"_blank\",\n    title: \"a number to word list converter as a node backend and react/redux fronted package.json\"\n  }, \"webpack.config.js\"), \". Well it's not that complicated, the only nasty detail is that even if you want to pass in a simple string, you need to wrap it with a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JSON.stringify\"), \" otherwise, webpack dumps whatever text comes out of your environment variable and dump it in your JavaScript, and you get a very nasty syntax error. So let's use the \", mdx(\"a\", {\n    href: \"https://webpack.js.org/plugins/define-plugin/#usage\",\n    target: \"_blank\",\n    title: \"the defineplugin allows you to create global constants which can be configured at compile time\"\n  }, \"DefinePlugin\"), \":\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"new webpack.DefinePlugin({\\n  __commitHash__: JSON.stringify(process.env.COMMIT_HASH),\\n});\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Pro Tip\"), \": You might be wondering why the strange naming \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"__commitHash__,\"), \" well the prefix and suffix underscores are just a way to prevent naming collisions. I hope that you don't often use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"__var__\"), \" as a style to name variables in JavaScript, well I don't, that's why I found this extremely unlikely to collide.\"), mdx(\"h5\", {\n    \"id\": \"step-3---use-the-environment-variables\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Step 3 - Use the environment variables\", mdx(\"a\", _extends({\n    parentName: \"h5\"\n  }, {\n    \"href\": \"#step-3---use-the-environment-variables\",\n    \"aria-label\": \"step 3   use the environment variables permalink\",\n    \"className\": \"anchor after\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"style\": {\n      \"paddingLeft\": \"12px\"\n    },\n    \"width\": \"28\",\n    \"height\": \"16\",\n    \"fill\": \"#9f7aea\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))))), mdx(\"p\", null, \"In the end, we use the environment variable. In this case to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"console.log\"), \" a helpful GitHub link:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"console.log(\\n  `You are running on this commit of the application https://github.com/danielcaldas/el-conversor/commit/${__commitHash__}`\\n);\\n\")), mdx(\"p\", null, \"You can see the final result in the image below, it logs:\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\\"You are running on this commit of the application \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/danielcaldas/el-conversor/commit/aad949425d37ae8d8f4ef0285e8ba2df4e4df6b3\"\n  }), \"https://github.com/danielcaldas/el-conversor/commit/aad949425d37ae8d8f4ef0285e8ba2df4e4df6b3\"), \"\\\"\")), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"37.916666666666664%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAAA8ElEQVQY06WOzXKFIAyFff/X61hHUQwI8o/oBe/CahtvV122PcMiOeQ7SaXmWSm1bRtjjBCCnXWhfm/rplvSxjnvCQkhWGOwgJEyBimt6ORcKikEAMQQtNbe+xjjbNPAbQd6NhFHJ2mUXULKzq9SRy600QqHnXOV0VpKaa3FA0opGQNzfj73x4bxHmEkR+HWcmz7h467VJ72BIBRSisMoCNoY8YRSN8D4/cHAJ9ERwb0GZ/oyOqmbcnwVjfTJHDT941VyQV5rLxzuCrG4F9a13SbPqSU0MeXlgUxNI/jOF+qPv+hGz6v8/qNfsDXXzd/AUHfw5N/+M11AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"final result in console of el-conversor\",\n    \"title\": \"final result in console of el-conversor\",\n    \"src\": \"/static/a76ae6aea35262e747f27086d97abfd5/7d769/console-log.png\",\n    \"srcSet\": [\"/static/a76ae6aea35262e747f27086d97abfd5/5243c/console-log.png 240w\", \"/static/a76ae6aea35262e747f27086d97abfd5/ab158/console-log.png 480w\", \"/static/a76ae6aea35262e747f27086d97abfd5/7d769/console-log.png 960w\", \"/static/a76ae6aea35262e747f27086d97abfd5/ba1cc/console-log.png 1062w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(Caption, {\n    mdxType: \"Caption\"\n  }));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"The odds are high that you're using  webpack  to bundle your assets. If you're looking into an excellent way to feed environment variablesâ€¦","timeToRead":2,"banner":null,"parent":{"__typename":"Mdx","frontmatter":{"subtitle":null}}}},"pageContext":{"slug":"/blog/hidden-potential-webpack-define-plugin/","formatString":"DD.MM.YYYY"}}}